function [L,Plist] = setup(N)
%Assuming n = 2^k-1
l = 1;
Nl = N;
Nlist = Nl;
while Nl > 20
    l = l + 1;
    Nl = ((sqrt(Nl)-1)/2)^2;
    Nlist(l) = Nl;
end
L = l;
Nlist = fliplr(Nlist); % coarsest level: l = 1, fine level: l = L

Plist = {};
for l = L:(L-1
    Plist{l}
